<!DOCTYPE html>
<html lang="lt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pretenzija #ID</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #2D2D2D;
            --light: #F5F5F5;
            --white: #FFFFFF;
            --gray: #75757d;
            --font: 'Roboto', sans-serif;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: var(--font);
            background: var(--light);
            color: #333;
            font-size: 12px;
            line-height: 1.4;
        }
        .container {
            max-width: 1400px;
            margin: 20px auto;
            padding: 15px;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        .section {
            background: var(--white);
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 6px rgba(0,0,0,0.1);
            margin-bottom: 15px;
            border: 1px solid #eee;
        }
        .section h3 {
            font-size: 13px;
            color: var(--primary);
            margin-bottom: 10px;
            padding-bottom: 5px;
            border-bottom: 1px solid #eee;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        .section h3::before {
            content: "";
            display: inline-block;
            width: 6px;
            height: 6px;
            background: var(--primary);
            border-radius: 50%;
            margin-right: 6px;
        }
        .field {
            margin-bottom: 6px;
            word-break: break-word;
        }
        .field-label {
            font-weight: 500;
            color: #555;
            min-width: 100px;
            display: inline-block;
        }
        .file-item {
            font-size: 11px;
            margin: 3px 0;
            word-break: break-all;
        }
        .file-item a {
            color: #17a2b8;
            text-decoration: none;
        }
        .file-item a:hover {
            text-decoration: underline;
        }
        footer {
            text-align: center;
            margin-top: 40px;
            color: var(--gray);
            font-size: 11px;
            padding: 20px;
            border-top: 1px solid #ddd;
        }
        @media (max-width: 768px) {
            .container {
                grid-template-columns: 1fr;
            }
        }
/* Timeline (veiksm≈≥ istorija) */
.timeline {
    margin-top: 10px;
    padding-left: 10px;
    position: relative;
}
.timeline::before {
    content: '';
    position: absolute;
    left: 5px;
    top: 5px;
    bottom: 5px;
    width: 2px;
    background: #ccc;
}
.timeline-item {
    position: relative;
    margin-bottom: 10px;
    padding-left: 20px;
}
.timeline-item::before {
    content: '';
    position: absolute;
    left: 3px;
    top: 8px;
    width: 6px;
    height: 6px;
    background: #17a2b8;
    border-radius: 50%;
}
.timeline-item small {
    color: #777;
    font-size: 10px;
}



    </style>
</head>
<body>
    <div class="container">
        <!-- Kairƒó pusƒó: vartotojo informacija -->
        <div class="left-column">
            <div class="section">
                <h3>1. Pagrindinƒó informacija</h3>
                <div class="field"><span class="field-label">ID:</span> <span id="claim-id"></span></div>
                <div class="field"><span class="field-label">Data:</span> <span id="claim-date"></span></div>
                <div class="field"><span class="field-label">Tema:</span> <span id="claim-topic"></span></div>
                <div class="field"><span class="field-label">Veiklos tipas:</span> <span id="claim-role"></span></div>
                <div class="field"><span class="field-label">Produktas:</span> <span id="claim-product"></span></div>
                <div class="field"><span class="field-label">Apra≈°ymas:</span> <span id="claim-description"></span></div>
                <div class="field"><span class="field-label">Kliento reikalavimas:</span> <span id="claim-request"></span></div>
            </div>




            <div class="section">
                <h3>2. Kontaktiniai duomenys</h3>
                <div class="field"><span class="field-label">Vardas:</span> <span id="contact-name"></span></div>
                <div class="field"><span class="field-label">Pavardƒó:</span> <span id="contact-surname"></span></div>
                <div class="field"><span class="field-label">El. pa≈°tas:</span> <span id="contact-email"></span></div>
                <div class="field"><span class="field-label">Telefonas:</span> <span id="contact-phone"></span></div>
                <div class="field"><span class="field-label">Adresas:</span> <span id="contact-address"></span></div>
                <div class="field"><span class="field-label">Miestas:</span> <span id="contact-city"></span></div>
                <div class="field"><span class="field-label">Pa≈°to kodas:</span> <span id="contact-postal"></span></div>
                <div class="field"><span class="field-label">Pageidaujamas kontaktas:</span> <span id="contact-method"></span></div>
                <div class="field"><span class="field-label">Patogus laikas:</span> <span id="preferred-time"></span></div>
            </div>

            <div class="section">
                <h3>3. Pridƒóti failai</h3>
                <div id="claim-files"></div>
            </div>

            <div class="section">
                <h3>4. Atsakymas klientui</h3>
                <p id="client-response">Nƒóra i≈°si≈≥sto atsakymo klientui.</p>
            </div>
        </div>

        <!-- De≈°inƒó pusƒó: vidinƒó informacija -->
        <div class="right-column">
            <div class="section">
                <h3>5. Kokybƒós skyriaus komentarai</h3>
                <p id="quality-note">Nƒóra papildom≈≥ pastab≈≥ partneriui.</p>
            </div>

            <div class="section">
                <h3>6. Atsakingas asmuo</h3>
                <div class="field"><span class="field-label">Vardas:</span> <span id="responsible-name"></span></div>
                <div class="field"><span class="field-label">Pavardƒó:</span> <span id="responsible-surname"></span></div>
                <div class="field"><span class="field-label">Pareigos:</span> <span id="responsible-role"></span></div>
                <div class="field"><span class="field-label">El. pa≈°tas:</span> <span id="responsible-email"></span></div>
                <div class="field"><span class="field-label">Telefonas:</span> <span id="responsible-phone"></span></div>
            </div>

            <div class="section">
                <h3>7. Priskirtas partneris</h3>
                <div class="field"><span class="field-label">Pavadinimas:</span> <span id="partner-name"></span></div>
                <div class="field"><span class="field-label">Kontaktas:</span> <span id="partner-contact"></span></div>
                <div class="field"><span class="field-label">Tel.:</span> <span id="partner-phone"></span></div>
                <div class="field"><span class="field-label">El. pa≈°tas:</span> <span id="partner-email"></span></div>
            </div>

            <div class="section">
                <h3>8. B≈´sena ir komentarai</h3>
                <div class="field"><span class="field-label">B≈´sena:</span> <span id="claim-status"></span></div>
                <div class="field"><span class="field-label">Komentaras:</span> <span id="quality-comment"></span></div>
            </div>

            <div class="section">
    <h3>9. Veiksm≈≥ istorija</h3>
    <div id="timeline-container" class="timeline"></div>
</div>
        </div>
    </div>

    <footer>¬© 2025 Rubineta. Visos teisƒós saugomos. | info@rubineta.lt</footer>

    <script>
        // Gauti ID i≈° URL
        const urlParams = new URLSearchParams(window.location.search);
        const claimId = urlParams.get('id');

        if (!claimId) {
            alert('Nenurodytas pretenzijos ID.');
            history.back();
        }

        // Rasti pretenzijƒÖ
        const claims = JSON.parse(localStorage.getItem('claims') || '[]');
        const claim = claims.find(c => c.id === claimId);

        if (!claim) {
            alert('Pretenzija nerasta.');
            history.back();
        }

        // U≈æpildyti kairƒô pusƒô
        document.getElementById('claim-id').textContent = claim.id;
        document.getElementById('claim-date').textContent = new Date(claim.date).toLocaleString('lt-LT');
        document.getElementById('claim-topic').textContent = claim.topic;
        document.getElementById('claim-role').textContent = claim.role;
        document.getElementById('claim-product').textContent = claim.product;
        document.getElementById('claim-description').textContent = claim.description;
        document.getElementById('claim-request').textContent = claim.request;

        document.getElementById('contact-name').textContent = claim.contact.name;
        document.getElementById('contact-surname').textContent = claim.contact.surname;
        document.getElementById('contact-email').textContent = claim.contact.email;
        document.getElementById('contact-phone').textContent = claim.contact.phone;
        document.getElementById('contact-address').textContent = claim.contact.street;
        document.getElementById('contact-city').textContent = claim.contact.city;
        document.getElementById('contact-postal').textContent = claim.contact.postal;
        document.getElementById('contact-method').textContent = claim.contactMethod;
        document.getElementById('preferred-time').textContent = claim.preferredTime;

        // Failai
const filesContainer = document.getElementById('claim-files');
let fileListHtml = ''; // ‚úÖ 1. Apibrƒó≈æk kintamƒÖjƒØ

if (claim.files && claim.files.length > 0) {
    claim.files.forEach(file => {
        if (file.includes('/video/')) {
            fileListHtml += `<div class="file-item"><video controls src="${file}" style="max-width:100%"></video></div>`;
        } else if (file.endsWith('.pdf')) {
    const pdfUrl = file + '?dl=1'; // Priverƒçia atsisi≈≥sti
    fileListHtml += `<div class="file-item"><a href="${pdfUrl}" target="_blank">üìÑ ${file.split('/').pop()}</a></div>`;
} else {
            fileListHtml += `<div class="file-item"><img src="${file}" style="max-width:100%;border-radius:4px"></div>`;
        }
    });
} else {
    fileListHtml = '<div class="file-item">Nƒóra ƒØkelt≈≥ fail≈≥</div>'; // ‚úÖ Naudok `=` vietoj `+=`
}

// ‚úÖ 2. ƒÆdƒók ƒØ konteinerƒØ
filesContainer.innerHTML = fileListHtml;

        // Atsakymas klientui
        document.getElementById('client-response').textContent = claim.qualityResponseToClient || 'Nƒóra i≈°si≈≥sto atsakymo klientui.';

        // De≈°inƒó pusƒó
        document.getElementById('quality-note').textContent = claim.qualityNote || 'Nƒóra papildom≈≥ pastab≈≥ partneriui.';
        document.getElementById('quality-comment').textContent = claim.qualityComment || 'Nƒóra komentaro.';

        // Atsakingas
        if (claim.responsible) {
            const [name, surname] = claim.responsible.split(' ');
            document.getElementById('responsible-name').textContent = name;
            document.getElementById('responsible-surname').textContent = surname;
            // Jei turi papildomus duomenis ‚Äì galima pridƒóti i≈° `adminUsers`
        }

        // Priskirtas partneris
        if (claim.assignedPartner) {
            document.getElementById('partner-name').textContent = claim.assignedPartner;
        }

        // B≈´sena
        document.getElementById('claim-status').textContent = claim.status;
    // --- VEIKSM≈≤ ISTORIJA (TIMELINE) ---
const timeline = document.getElementById('timeline-container');
timeline.innerHTML = ''; // I≈°valo ankstesnƒØ turinƒØ

// Sukuriam istorijos ƒØra≈°us
const historyEvents = [
    { user: 'Sistema', time: claim.date, action: 'Pretenzija pateikta' },
    { user: claim.responsible || 'Kokybƒós skyrius', time: claim.date, action: `B≈´sena: ${claim.status}` },
    { user: claim.assignedPartner || 'Sistema', time: claim.date, action: claim.assignedPartner ? `Priskirta partneriui` : 'Laukia priskyrimo' }
];

// Sugeneruojam kiekvienƒÖ ƒØra≈°ƒÖ
historyEvents.forEach(event => {
    const item = document.createElement('div');
    item.className = 'timeline-item';
    item.innerHTML = `
        <strong>${event.user}</strong>
        <small>${new Date(event.time).toLocaleString('lt-LT')}</small>
        <div>${event.action}</div>
    `;
    timeline.appendChild(item);
});
    
    </script>
</body>
</html>
