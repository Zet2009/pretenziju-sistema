<!DOCTYPE html>
<html lang="lt">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <title>Meistro u≈æduotys</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
  <style>
    * { margin:0; padding:0; box-sizing:border-box; }
    body {
      font-family: 'Roboto', sans-serif;
      background: #f5f7fa;
      color: #2d3748;
      line-height: 1.6;
      user-select: none;
    }
    .container { max-width: 428px; margin: 0 auto; background: white; min-height: 100vh; }
    .header {
      background: #111; color: white; padding: 1rem;
      position: sticky; top: 0; z-index: 100;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    .offline-indicator {
      display: none; background: #ef4444; color: white;
      padding: 0.5rem; text-align: center; font-size: 0.875rem;
    }
    .search-container { padding: 1rem; border-bottom: 1px solid #e5e7eb; }
    .search-input {
      width: 100%; padding: 0.75rem; border: 1px solid #d1d5db;
      border-radius: 0.5rem; font-size: 1rem; background: white;
    }
    .tabs {
      display: flex; border-bottom: 1px solid #e5e7eb; background: white;
    }
    .tab {
      flex: 1; padding: 0.75rem; text-align: center;
      background: none; border: none; cursor: pointer;
      font-size: 0.875rem; color: #6b7280;
    }
    .tab.active { color: #111; border-bottom: 2px solid #111; background: #f8fafc; }
    .task-list { padding: 1rem; }
    .task-card {
      background: white; border: 1px solid #e5e7eb; border-radius: 0.875rem;
      margin-bottom: 1rem; box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }
    .task-header { padding: 1rem; border-bottom: 1px solid #f3f4f6; }
    .task-id-status { display: flex; justify-content: space-between; margin-bottom: 0.5rem; }
    .task-id { font-weight: 600; color: #374151; font-size: 0.875rem; }
    .status-badge {
      padding: 0.25rem 0.5rem; border-radius: 9999px;
      font-size: 0.75rem; font-weight: 500;
    }
    .status-new { background: #fef3c7; color: #92400e; }
    .status-progress { background: #dbeafe; color: #1e40af; }
    .status-waiting { background: #fed7aa; color: #ea580c; }
    .status-completed { background: #d1fae5; color: #065f46; }
    .task-description { font-weight: 500; color: #1f2937; margin-bottom: 0.5rem; }
    .task-product { color: #6b7280; font-size: 0.875rem; }
    .task-footer { padding: 0.75rem 1rem; background: #f9fafb; display: flex; justify-content: space-between; }
    .task-contact { font-size: 0.875rem; color: #6b7280; }
    .task-date { font-size: 0.75rem; color: #9ca3af; }
    .status-select {
      padding: 0.25rem 0.5rem; border: 1px solid #d1d5db;
      border-radius: 0.375rem; font-size: 0.75rem; background: white;
    }
    .detail-view { display: none; background: #f5f7fa; min-height: 100vh; }
    .detail-header {
      background: white; padding: 1rem; border-bottom: 1px solid #e5e7eb;
      display: flex; align-items: center; gap: 1rem;
    }
    .back-button {
      background: none; border: none; color: #111; font-size: 1.5rem;
      cursor: pointer; padding: 0.5rem; border-radius: 0.5rem;
    }
    .detail-content { padding: 1rem; }
    .detail-card {
      background: white; border-radius: 0.875rem; margin-bottom: 1rem;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }
    .detail-card-header {
      padding: 1rem; border-bottom: 1px solid #f3f4f6;
      display: flex; justify-content: space-between; align-items: center;
    }
    .detail-card-title { font-weight: 600; color: #1f2937; }
    .detail-card-content { padding: 1rem; }
    .form-textarea {
      width: 100%; padding: 0.75rem; border: 1px solid #d1d5db;
      border-radius: 0.5rem; min-height: 100px; resize: vertical;
    }
    .part-item { display: flex; gap: 0.5rem; margin-bottom: 0.5rem; }
    .part-input {
      flex: 1; padding: 0.5rem; border: 1px solid #d1d5db;
      border-radius: 0.375rem; font-size: 0.875rem;
    }
    .part-remove {
      background: #ef4444; color: white; border: none;
      border-radius: 0.375rem; padding: 0.5rem; cursor: pointer;
    }
    .photo-grid {
      display: grid; grid-template-columns: repeat(2, 1fr); gap: 0.5rem;
    }
    .photo-item { position: relative; }
    .photo-img {
      width: 100%; height: 96px; object-fit: cover;
      border-radius: 0.375rem; border: 1px solid #e5e7eb;
    }
    .photo-delete {
      position: absolute; top: 0.25rem; right: 0.25rem;
      background: #ef4444; color: white; border: none;
      border-radius: 50%; width: 24px; height: 24px;
      display: flex; align-items: center; justify-content: center;
      font-size: 0.75rem; cursor: pointer;
    }
    .signature-canvas {
      width: 100%; height: 144px; border: 2px dashed #d1d5db;
      border-radius: 0.5rem; background: white; cursor: crosshair;
      touch-action: none;
    }
    .annotate-canvas {
      width: 100%; height: 200px; border: 2px dashed #d1d5db;
      border-radius: 0.5rem; background: white; cursor: crosshair;
      touch-action: none; display: none;
    }
    .button {
      display: inline-flex; align-items: center; justify-content: center;
      padding: 0.75rem 1rem; border: none; border-radius: 0.5rem;
      font-size: 0.875rem; font-weight: 500; cursor: pointer;
      text-decoration: none;
    }
    .button-primary { background: #111; color: white; }
    .button-outline { background: white; color: #374151; border: 1px solid #d1d5db; }
    .button-sm { padding: 0.5rem 0.75rem; font-size: 0.75rem; }
    .flex { display: flex; }
    .gap-2 { gap: 0.5rem; }
    .w-full { width: 100%; }
    .mt-4 { margin-top: 1rem; }
  </style>
</head>
<body>
  <div class="container">
    <div id="offlineIndicator" class="offline-indicator">‚ö†Ô∏è Offline ‚Äì duomenys saugomi ƒØrenginyje</div>

    <!-- SƒÑRA≈†AS -->
    <div id="listView">
      <div class="header">
        <h1>Meistro u≈æduotys</h1>
      </div>
      <div class="search-container">
        <input type="text" class="search-input" placeholder="Ie≈°koti..." id="searchInput">
      </div>
      <div class="tabs">
        <button class="tab active" data-filter="open">Aktyvios <span id="openCount">0</span></button>
        <button class="tab" data-filter="waiting">Laukia dali≈≥ <span id="waitingCount">0</span></button>
        <button class="tab" data-filter="completed">U≈æbaigtos <span id="completedCount">0</span></button>
        <button class="tab" data-filter="all">Visos <span id="allCount">0</span></button>
      </div>
      <div id="taskList" class="task-list"></div>
    </div>

    <!-- DETALƒñS -->
    <div id="detailView" class="detail-view">
      <div class="detail-header">
        <button id="backButton" class="back-button">‚Üê</button>
        <h2 id="detailTitle">U≈æduotis</h2>
      </div>
      <div class="detail-content">
        <!-- Info -->
        <div class="detail-card">
          <div class="detail-card-header">
            <div class="detail-card-title">üìã Informacija</div>
            <span id="detailStatus" class="status-badge"></span>
          </div>
          <div class="detail-card-content" id="detailInfo"></div>
        </div>

        <!-- Pastabos -->
        <div class="detail-card">
          <div class="detail-card-header">
            <div class="detail-card-title">üìù Pastabos</div>
          </div>
          <div class="detail-card-content">
            <textarea id="notesTextarea" class="form-textarea" placeholder="ƒÆra≈°ykite pastabas..."></textarea>
          </div>
        </div>

        <!-- Dalys -->
        <div class="detail-card">
          <div class="detail-card-header">
            <div class="detail-card-title">üîß Dalys</div>
            <button id="addPartButton" class="button button-outline button-sm">Pridƒóti</button>
          </div>
          <div class="detail-card-content">
            <div id="partsList"></div>
          </div>
        </div>

        <!-- Nuotraukos -->
        <div class="detail-card">
          <div class="detail-card-header">
            <div class="detail-card-title">üì∑ Nuotraukos (<span id="photoCount">0</span>)</div>
            <button id="addPhotoButton" class="button button-primary button-sm">Fotografuoti</button>
          </div>
          <div class="detail-card-content">
            <div id="photoGrid" class="photo-grid"></div>
          </div>
        </div>

        <!-- Anotacijos -->
        <div class="detail-card">
          <div class="detail-card-header">
            <div class="detail-card-title">‚úèÔ∏è Anotuoti paskutinƒô</div>
            <button id="annotateButton" class="button button-outline button-sm" disabled>Anotuoti</button>
          </div>
          <div class="detail-card-content">
            <canvas id="annotateCanvas" class="annotate-canvas"></canvas>
            <div class="flex gap-2 mt-4">
              <button id="annotateSaveButton" class="button button-primary w-full" disabled>I≈°saugoti</button>
            </div>
          </div>
        </div>

        <!-- Para≈°as -->
        <div class="detail-card">
          <div class="detail-card-header">
            <div class="detail-card-title">‚úçÔ∏è Para≈°as</div>
          </div>
          <div class="detail-card-content">
            <canvas id="signatureCanvas" class="signature-canvas"></canvas>
            <div class="flex gap-2 mt-4">
              <button id="clearSignatureButton" class="button button-outline w-full">I≈°valyti</button>
              <button id="saveSignatureButton" class="button button-primary w-full">I≈°saugoti</button>
            </div>
          </div>
        </div>

        <!-- I≈°saugoti -->
        <div class="mt-4">
          <button id="saveTaskButton" class="button button-primary w-full">üíæ I≈°saugoti</button>
        </div>
      </div>
    </div>

    <!-- Kamera -->
    <div id="cameraContainer" style="display:none; position:fixed; top:0; left:0; right:0; bottom:0; background:black; z-index:1000;">
      <video id="cameraVideo" autoplay muted playsinline style="width:100%; height:100%; object-fit:cover;"></video>
      <div style="position:absolute; bottom:2rem; left:0; right:0; display:flex; justify-content:center; gap:1rem;">
        <button id="closeCameraButton" style="background:white; border:none; border-radius:50%; width:60px; height:60px;">‚úï</button>
        <button id="captureButton" style="background:#ef4444; color:white; border:none; border-radius:50%; width:80px; height:80px; font-size:2rem;">üì∏</button>
      </div>
    </div>
  </div>

  <script>
  // ==================== DUOMEN≈≤ VALDYMAS (pagal master-mobile.html) ====================
  const STORAGE_KEY = 'claims'; // Svarbu: tas pats raktas kaip master-mobile.html
  let claims = JSON.parse(localStorage.getItem(STORAGE_KEY) || '[]');
  let currentId = null;
  let lastPhotoDataUrl = null;
  let cameraStream = null;

  const saveClaims = () => localStorage.setItem(STORAGE_KEY, JSON.stringify(claims));

  // ==================== PAGALBINƒñS FUNKCIJOS ====================
  const fmtDate = d => new Date(d).toLocaleDateString('lt-LT');
  const fmtTime = d => new Date(d).toLocaleTimeString('lt-LT', { hour: '2-digit', minute: '2-digit' });
  const getStatusClass = s => {
    if (s === 'U≈æbaigta') return 'status-completed';
    if (s === 'Laukia dali≈≥') return 'status-waiting';
    if (s === 'Vykdoma') return 'status-progress';
    return 'status-new';
  };

  // ==================== KAMERA ====================
  async function startCamera() {
    try {
      cameraStream = await navigator.mediaDevices.getUserMedia({ video: { facingMode: 'environment' } });
      document.getElementById('cameraVideo').srcObject = cameraStream;
      document.getElementById('cameraContainer').style.display = 'block';
    } catch (e) {
      alert('Nepavyko paleisti kameros.');
    }
  }

  function capturePhoto() {
    const video = document.getElementById('cameraVideo');
    const canvas = document.createElement('canvas');
    canvas.width = video.videoWidth;
    canvas.height = video.videoHeight;
    const ctx = canvas.getContext('2d');
    ctx.drawImage(video, 0, 0);
    const dataUrl = canvas.toDataURL('image/jpeg', 0.85);
    closeCamera();

    const claim = claims.find(c => c.id === currentId);
    if (!claim.masterAttachments) claim.masterAttachments = [];
    claim.masterAttachments.push({ type: 'image', dataUrl, name: `photo-${Date.now()}.jpg` });
    lastPhotoDataUrl = dataUrl;
    document.getElementById('annotateButton').disabled = false;
    saveClaims();
    renderPhotos();
  }

  function closeCamera() {
    if (cameraStream) {
      cameraStream.getTracks().forEach(t => t.stop());
      cameraStream = null;
    }
    document.getElementById('cameraContainer').style.display = 'none';
  }

  // ==================== ANOTACIJOS ====================
  function startAnnotate() {
    if (!lastPhotoDataUrl) return;
    const canvas = document.getElementById('annotateCanvas');
    const ctx = canvas.getContext('2d');
    const img = new Image();
    img.onload = () => {
      const maxWidth = canvas.parentElement.clientWidth - 20;
      const scale = Math.min(maxWidth / img.width, 1);
      canvas.width = img.width * scale;
      canvas.height = img.height * scale;
      canvas.style.display = 'block';
      ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
      ctx.strokeStyle = '#ff0000';
      ctx.lineWidth = 3;
      ctx.lineCap = 'round';
      let isDrawing = false;
      let last = null;
      canvas.onpointerdown = e => {
        isDrawing = true;
        const rect = canvas.getBoundingClientRect();
        const x = e.clientX - rect.left;
        const y = e.clientY - rect.top;
        last = { x, y };
      };
      canvas.onpointermove = e => {
        if (!isDrawing || !last) return;
        const rect = canvas.getBoundingClientRect();
        const x = e.clientX - rect.left;
        const y = e.clientY - rect.top;
        ctx.beginPath();
        ctx.moveTo(last.x, last.y);
        ctx.lineTo(x, y);
        ctx.stroke();
        last = { x, y };
      };
      canvas.onpointerup = canvas.onpointercancel = () => isDrawing = false;
      document.getElementById('annotateSaveButton').disabled = false;
    };
    img.src = lastPhotoDataUrl;
  }

  function saveAnnotate() {
    const canvas = document.getElementById('annotateCanvas');
    const dataUrl = canvas.toDataURL('image/jpeg', 0.85);
    const claim = claims.find(c => c.id === currentId);
    const atts = claim.masterAttachments;
    for (let i = atts.length - 1; i >= 0; i--) {
      if (atts[i].dataUrl === lastPhotoDataUrl) {
        atts[i].dataUrl = dataUrl;
        lastPhotoDataUrl = dataUrl;
        break;
      }
    }
    saveClaims();
    renderPhotos();
    canvas.style.display = 'none';
    document.getElementById('annotateSaveButton').disabled = true;
  }

  // ==================== PARA≈†AS ====================
  let isSigDrawing = false, sigLast = null;
  function initSigCanvas() {
    const canvas = document.getElementById('signatureCanvas');
    const ctx = canvas.getContext('2d');
    const rect = canvas.getBoundingClientRect();
    const dpr = window.devicePixelRatio || 1;
    canvas.width = rect.width * dpr;
    canvas.height = rect.height * dpr;
    ctx.scale(dpr, dpr);
    ctx.fillStyle = '#fff';
    ctx.fillRect(0, 0, rect.width, rect.height);
    ctx.strokeStyle = '#000';
    ctx.lineWidth = 2;
    ctx.lineCap = 'round';
  }

  function clearSignature() {
    initSigCanvas();
  }

  function saveSignature() {
    const canvas = document.getElementById('signatureCanvas');
    const ctx = canvas.getContext('2d');
    const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
    const isEmpty = imageData.data.every((val, i) => !(i % 4 < 3) || val === 0 || (i % 4 === 3 && val === 0));
    if (isEmpty) { alert('Nupie≈°kite para≈°ƒÖ.'); return; }

    const dataUrl = canvas.toDataURL('image/png');
    const claim = claims.find(c => c.id === currentId);
    if (!claim.masterAttachments) claim.masterAttachments = [];
    claim.masterAttachments.push({ type: 'image', dataUrl, name: `parasas-${Date.now()}.png` });
    saveClaims();
    alert('Para≈°as i≈°saugotas!');
  }

  // ==================== RODOMA SƒÑRA≈†E ====================
  function renderList() {
    const term = document.getElementById('searchInput').value.toLowerCase();
    const filter = document.querySelector('.tab.active').dataset.filter;
    let filtered = claims.filter(c => {
      const match = [c.id, c.description, c.product, c?.contact?.name, c?.contact?.surname, c?.contact?.city].join(' ').toLowerCase().includes(term);
      if (!match) return false;
      if (filter === 'completed') return c.status === 'U≈æbaigta';
      if (filter === 'waiting') return c.status === 'Laukia dali≈≥';
      if (filter === 'open') return c.status !== 'U≈æbaigta';
      return true;
    });

    document.getElementById('taskList').innerHTML = filtered.map(c => {
      const addr = [c?.contact?.street, c?.contact?.city].filter(Boolean).join(', ');
      return `
        <div class="task-card" onclick="openDetail('${c.id}')">
          <div class="task-header">
            <div class="task-id-status">
              <span class="task-id">#${c.id}</span>
              <span class="status-badge ${getStatusClass(c.status)}">${c.status}</span>
            </div>
            <div class="task-description">${c.description || '‚Äì'}</div>
            <div class="task-product">${c.product || '‚Äì'}</div>
          </div>
          <div class="task-footer">
            <div class="task-contact">${c?.contact?.name || ''} ${c?.contact?.surname || ''}</div>
            <div class="task-date">${fmtDate(c.date)}</div>
          </div>
          <div class="task-footer">
            <div class="task-contact">${addr}</div>
            <select class="status-select" onchange="setStatus('${c.id}', this.value)">
              <option value="Nauja" ${c.status === 'Nauja' ? 'selected' : ''}>Nauja</option>
              <option value="Vykdoma" ${c.status === 'Vykdoma' ? 'selected' : ''}>Vykdoma</option>
              <option value="Laukia dali≈≥" ${c.status === 'Laukia dali≈≥' ? 'selected' : ''}>Laukia dali≈≥</option>
              <option value="U≈æbaigta" ${c.status === 'U≈æbaigta' ? 'selected' : ''}>U≈æbaigta</option>
            </select>
          </div>
        </div>
      `;
    }).join('');

    document.getElementById('openCount').textContent = claims.filter(c => c.status !== 'U≈æbaigta').length;
    document.getElementById('waitingCount').textContent = claims.filter(c => c.status === 'Laukia dali≈≥').length;
    document.getElementById('completedCount').textContent = claims.filter(c => c.status === 'U≈æbaigta').length;
    document.getElementById('allCount').textContent = claims.length;
  }

  // ==================== DETALƒñS ====================
  function openDetail(id) {
    currentId = id;
    const c = claims.find(x => x.id === id);
    if (!c) return;

    document.getElementById('listView').style.display = 'none';
    document.getElementById('detailView').style.display = 'block';

    document.getElementById('detailTitle').textContent = c.description || 'U≈æduotis';
    document.getElementById('detailStatus').textContent = c.status;
    document.getElementById('detailStatus').className = 'status-badge ' + getStatusClass(c.status);

    const addr = [c?.contact?.street, c?.contact?.city, c?.contact?.postal].filter(Boolean).join(', ');
    document.getElementById('detailInfo').innerHTML = `
      <div><strong>Produktas:</strong> ${c.product || '‚Äì'}</div>
      <div><strong>Klientas:</strong> ${c?.contact?.name || ''} ${c?.contact?.surname || ''}</div>
      <div><strong>Adresas:</strong> ${addr || '‚Äì'}</div>
      <div><strong>Telefonas:</strong> ${c?.contact?.phone || '‚Äì'}</div>
      <div><strong>Data:</strong> ${fmtDate(c.date)} ${fmtTime(c.date)}</div>
    `;

    document.getElementById('notesTextarea').value = c.notes || '';
    renderParts(c.parts || []);
    renderPhotos();
    setTimeout(initSigCanvas, 100);
  }

  function renderParts(parts) {
    const el = document.getElementById('partsList');
    el.innerHTML = parts.map((p, i) => `
      <div class="part-item">
        <input class="part-input" value="${p}" onchange="updatePart(${i}, this.value)">
        <button class="part-remove" onclick="removePart(${i})">‚úï</button>
      </div>
    `).join('');
    el.innerHTML += `<div class="part-item"><input class="part-input" placeholder="Nauja dalis‚Ä¶" onchange="addPart(this.value)"></div>`;
  }

  function renderPhotos() {
    const claim = claims.find(c => c.id === currentId);
    const photos = (claim?.masterAttachments || []).filter(a => a.type === 'image');
    document.getElementById('photoCount').textContent = photos.length;
    document.getElementById('photoGrid').innerHTML = photos.map((p, i) => `
      <div class="photo-item">
        <img src="${p.dataUrl}" class="photo-img">
        <button class="photo-delete" onclick="deletePhoto(${i})">‚úï</button>
      </div>
    `).join('');
    lastPhotoDataUrl = photos.length ? photos[photos.length - 1].dataUrl : null;
    document.getElementById('annotateButton').disabled = !lastPhotoDataUrl;
  }

  // ==================== VEIKSMAI ====================
  window.setStatus = (id, status) => {
    const c = claims.find(x => x.id === id);
    if (c) { c.status = status; saveClaims(); renderList(); }
  };

  function updatePart(i, val) {
    const c = claims.find(x => x.id === currentId);
    if (c) { c.parts[i] = val; saveClaims(); }
  }

  function addPart(val) {
    if (!val.trim()) return;
    const c = claims.find(x => x.id === currentId);
    if (c) { c.parts = [...(c.parts || []), val.trim()]; saveClaims(); renderParts(c.parts); }
  }

  function removePart(i) {
    const c = claims.find(x => x.id === currentId);
    if (c) { c.parts.splice(i, 1); saveClaims(); renderParts(c.parts); }
  }

  function deletePhoto(i) {
    if (!confirm('I≈°trinti nuotraukƒÖ?')) return;
    const c = claims.find(x => x.id === currentId);
    if (c) { c.masterAttachments.splice(i, 1); saveClaims(); renderPhotos(); }
  }

  function saveTask() {
    const c = claims.find(x => x.id === currentId);
    if (c) { c.notes = document.getElementById('notesTextarea').value; saveClaims(); }
    alert('I≈°saugota!');
  }

  // ==================== PRISIJUNGIMAS / INICIALIZAVIMAS ====================
  // Jei reikia prisijungimo ‚Äì galima pridƒóti vƒóliau, bet ≈°iuo metu tiesiog naudojame localStorage
  document.getElementById('searchInput').addEventListener('input', renderList);
  document.querySelectorAll('.tab').forEach(tab => {
    tab.addEventListener('click', () => {
      document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
      tab.classList.add('active');
      renderList();
    });
  });

  document.getElementById('backButton').onclick = () => {
    document.getElementById('listView').style.display = 'block';
    document.getElementById('detailView').style.display = 'none';
    currentId = null;
    renderList();
  };

  document.getElementById('addPartButton').onclick = () => addPart('');

  document.getElementById('addPhotoButton').onclick = startCamera;
  document.getElementById('closeCameraButton').onclick = closeCamera;
  document.getElementById('captureButton').onclick = capturePhoto;

  document.getElementById('annotateButton').onclick = startAnnotate;
  document.getElementById('annotateSaveButton').onclick = saveAnnotate;

  const sigCanvas = document.getElementById('signatureCanvas');
  sigCanvas.addEventListener('pointerdown', e => {
    isSigDrawing = true;
    const rect = sigCanvas.getBoundingClientRect();
    const x = e.clientX - rect.left;
    const y = e.clientY - rect.top;
    sigLast = { x, y };
  });
  sigCanvas.addEventListener('pointermove', e => {
    if (!isSigDrawing || !sigLast) return;
    const rect = sigCanvas.getBoundingClientRect();
    const x = e.clientX - rect.left;
    const y = e.clientY - rect.top;
    const ctx = sigCanvas.getContext('2d');
    ctx.beginPath();
    ctx.moveTo(sigLast.x, sigLast.y);
    ctx.lineTo(x, y);
    ctx.stroke();
    sigLast = { x, y };
  });
  sigCanvas.addEventListener('pointerup', () => isSigDrawing = false);
  sigCanvas.addEventListener('pointercancel', () => isSigDrawing = false);

  document.getElementById('clearSignatureButton').onclick = clearSignature;
  document.getElementById('saveSignatureButton').onclick = saveSignature;
  document.getElementById('saveTaskButton').onclick = saveTask;

  renderList();
</script>
</body>
</html>
